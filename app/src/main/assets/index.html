<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate PDF Tools (Functional)</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>

    <style>
        :root{
            --color-bg-main:#0d0f14;
            --color-bg-sidebar:#12151a;
            --color-bg-navbar:#1c222d;
            --color-card-bg:#151920;
            --color-primary-accent:#42f8f5;
            --color-secondary-accent:#ff00e6;
            --color-text-primary:#fff;
            --color-text-secondary:#c0c8d3;
            --glow-shadow:0 0 5px var(--color-primary-accent),0 0 15px var(--color-primary-accent),0 0 25px rgba(66,248,245,.4);
            --glow-shadow-hover:0 0 8px var(--color-primary-accent),0 0 25px var(--color-primary-accent),0 0 45px rgba(66,248,245,.7);
            --font-family-main:'Orbitron',sans-serif;
            --border-radius:8px;
            --transition-speed:.3s
        }

        *{
            margin:0;
            padding:0;
            box-sizing:border-box
        }

        html,body{
            height:100%
        }

        body{
            font-family:'Segoe UI','Roboto',system-ui,sans-serif;
            background-color:var(--color-bg-main);
            color:var(--color-text-secondary);
            display:flex;
            flex-direction:column;
            overflow-x:hidden
        }

        h1,h2,h3,h4{
            font-family:var(--font-family-main);
            color:var(--color-text-primary);
            font-weight:700
        }

        a{
            color:var(--color-primary-accent);
            text-decoration:none;
            transition:color var(--transition-speed) ease
        }

        .main-wrapper{
            display:flex;
            flex:1;
            min-height:0
        }

        .header{
            background-color:var(--color-bg-navbar);
            height:70px;
            padding:0 1rem;
            display:flex;
            align-items:center;
            justify-content:center;
            position:sticky;
            top:0;
            z-index:1000;
            border-bottom:1px solid rgba(66,248,245,.2);
            padding-left:5rem;
            position:relative
        }

        .header h1{
            font-size:2rem;
            background:linear-gradient(45deg,var(--color-primary-accent),var(--color-secondary-accent));
            -webkit-background-clip:text;
            -webkit-text-fill-color:transparent;
            margin-left:1rem
        }

.hamburger{
    position:absolute;
    left:1rem;
    width:40px;
    height:40px;
    border:none;
    background:0 0;
    color:var(--color-text-primary);
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:1.5rem;
    transition:color var(--transition-speed) ease
}

.hamburger:hover{
    color:var(--color-primary-accent)
}

.sidebar{
    background-color:var(--color-bg-sidebar);
    width:300px;
    padding:2rem 1rem;
    transform:translateX(-100%);
    transition:transform var(--transition-speed) ease;
    position:fixed;
    height:100%;
    z-index:999;
    overflow-y:auto
}

.sidebar.active{
    transform:translateX(0)
}

.sidebar h2{
    margin-bottom:1.5rem;
    font-size:1.5rem;
    text-align:center
}

.tool-grid{
    display:grid;
    grid-template-columns:1fr;
    gap:1rem
}

.tool-card{
    background-color:var(--color-card-bg);
    border:1px solid rgba(66,248,245,.2);
    border-radius:var(--border-radius);
    padding:1.5rem;
    cursor:pointer;
    transition:all var(--transition-speed) ease;
    text-align:center
}

.tool-card:hover{
    transform:translateY(-5px);
    box-shadow:var(--glow-shadow)
}

.tool-card i{
    font-size:2rem;
    color:var(--color-primary-accent);
    margin-bottom:1rem
}

.tool-card h3{
    margin-bottom:.5rem;
    font-size:1.2rem
}

.tool-card p{
    font-size:.9rem;
    line-height:1.4
}

.main-content{
    flex:1;
    padding:2rem;
    margin-left:0;
    transition:margin var(--transition-speed) ease;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center
}

.welcome-message{
    max-width:800px;
    margin:0 auto
}

.welcome-message h2{
    font-size:2.5rem;
    margin-bottom:1rem;
    background:linear-gradient(45deg,var(--color-primary-accent),var(--color-secondary-accent));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent
}

.welcome-message p{
    font-size:1.1rem;
    line-height:1.6;
    margin-bottom:2rem
}

.cta-button{
    background-color:transparent;
    color:var(--color-primary-accent);
    border:2px solid var(--color-primary-accent);
    padding:.8rem 2rem;
    font-size:1rem;
    border-radius:var(--border-radius);
    cursor:pointer;
    transition:all var(--transition-speed) ease;
    font-family:var(--font-family-main);
    text-transform:uppercase;
    letter-spacing:1px
}

.cta-button:hover{
    background-color:var(--color-primary-accent);
    color:var(--color-bg-main);
    box-shadow:var(--glow-shadow-hover)
}

.modal-overlay{
    position:fixed;
    top:0;
    left:0;
    right:0;
    bottom:0;
    background-color:rgba(0,0,0,.8);
    display:none;
    z-index:1050
}

.modal-overlay.active{
    display:flex;
    justify-content:center;
    align-items:center
}

        .modal-container{
            background-color:var(--color-bg-sidebar);
            border-radius:var(--border-radius);
            width:90%;
            max-width:600px;
            position:relative;
            opacity:0;
            transform:scale(.8);
            transition:all var(--transition-speed) ease;
            display:none
        }

        .modal-container.active{
            opacity:1;
            transform:scale(1);
            display:block
        }

        .modal-header{
            padding:1.5rem;
            border-bottom:1px solid rgba(66,248,245,.2);
            display:flex;
            align-items:center;
            justify-content:space-between
        }

        .modal-header h2{
            font-size:1.5rem;
            margin:0
        }

        .modal-close{
            background:0 0;
            border:none;
            color:var(--color-text-primary);
            font-size:1.5rem;
            cursor:pointer;
            transition:color var(--transition-speed) ease
        }

        .modal-close:hover{
            color:var(--color-primary-accent)
        }

        .modal-body{
            padding:1.5rem;
            max-height:60vh;
            overflow-y:auto
        }

        .file-upload-area{
            border:2px dashed var(--color-primary-accent);
            border-radius:var(--border-radius);
            padding:2rem;
            text-align:center;
            margin-bottom:1rem;
            cursor:pointer;
            transition:all var(--transition-speed) ease
        }

        .file-upload-area:hover{
            border-color:var(--color-secondary-accent);
            box-shadow:var(--glow-shadow)
        }

        .file-upload-area i{
            font-size:2rem;
            color:var(--color-primary-accent);
            margin-bottom:1rem
        }

        .file-upload-area p{
            margin:0
        }

        .file-preview-container{
            margin-top:1rem
        }

        .file-preview-item{
            background-color:var(--color-card-bg);
            padding:1rem;
            border-radius:var(--border-radius);
            margin-bottom:.5rem;
            display:flex;
            align-items:center;
            justify-content:space-between
        }

        .file-preview-item i{
            margin-right:.5rem;
            color:var(--color-primary-accent)
        }

        .status-badge{
            background-color:rgba(66,248,245,.2);
            color:var(--color-primary-accent);
            padding:.25rem .5rem;
            border-radius:var(--border-radius);
            font-size:.8rem
        }

        .modal-options{
            margin-top:1rem
        }

        .modal-options label{
            display:block;
            margin-bottom:.5rem;
            color:var(--color-text-primary)
        }

        .modal-options select,.modal-options input{
            width:100%;
            padding:.5rem;
            background-color:var(--color-card-bg);
            border:1px solid rgba(66,248,245,.2);
            border-radius:var(--border-radius);
            color:var(--color-text-primary);
            font-size:1rem
        }

        .modal-footer{
            padding:1rem 1.5rem;
            border-top:1px solid rgba(66,248,245,.2);
            display:flex;
            justify-content:flex-end;
            align-items:center;
            background-color:var(--color-bg-main);
            position:relative;
            z-index:1051;
            width:100%
        }

        #process-btn {
            display: none;
            visibility: visible;
            opacity: 1;
            transition: opacity 0.3s ease;
            margin-left: auto;
            min-width: 120px;
            z-index: 1052;
        }

        .modal-container.active .modal-footer {
            opacity: 1;
            visibility: visible;
        }

        @media (max-width:768px){
            .header h1{
                font-size:1.5rem
            }

            .welcome-message h2{
                font-size:2rem
            }

            .modal-container{
                width:95%
            }
        }

        .loading-overlay{
            position:fixed;
            top:0;
            left:0;
            right:0;
            bottom:0;
            background-color:rgba(0,0,0,.9);
            display:none;
            justify-content:center;
            align-items:center;
            z-index:1100
        }

        .loading-spinner{
            width:50px;
            height:50px;
            border:3px solid var(--color-bg-main);
            border-top:3px solid var(--color-primary-accent);
            border-radius:50%;
            animation:spin 1s linear infinite
        }

        @keyframes spin{
            0%{
                transform:rotate(0)
            }
            100%{
                transform:rotate(360deg)
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <button class="hamburger" aria-label="Toggle Sidebar">
            <i class="fas fa-bars"></i>
        </button>
        <h1>Ultimate PDF Tools</h1>
    </header>

    <div class="main-wrapper">
        <aside class="sidebar">
            <h2>Available Tools</h2>
            <div class="tool-grid"></div>
        </aside>

        <main class="main-content">
            <div class="welcome-message">
                <h2>Welcome to Ultimate PDF Tools</h2>
                <p>Select a tool from the sidebar to get started. Our suite of PDF tools helps you manage and manipulate PDF files with ease. Whether you need to merge PDFs, convert files, or optimize your documents, we've got you covered.</p>
                <button class="cta-button" onclick="document.querySelector('.hamburger').click()">Explore Tools</button>
            </div>
        </main>
    </div>

    <div class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h2 id="modal-title">Tool Name</h2>
                <button class="modal-close" aria-label="Close Modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="file-upload-area">
                    <input type="file" id="file-input" hidden>
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Click or drag files here to upload</p>
                </div>
                <div id="file-previews" class="file-preview-container"></div>
                <div id="modal-options" class="modal-options"></div>
            </div>
            <div class="modal-footer">
                <button class="cta-button" id="process-btn">Process Files</button>
            </div>
        </div>
    </div>

    <div class="loading-overlay">
        <div class="loading-spinner"></div>
    </div>

    <script>
        const tools = [
            {
                name: 'Merge PDF',
                icon: 'fa-object-group',
                description: 'Combine multiple PDF files into a single document'
            },
            {
                name: 'Split PDF',
                icon: 'fa-cut',
                description: 'Extract pages from a PDF file into separate documents'
            },
            {
                name: 'PDF to JPG',
                icon: 'fa-file-image',
                description: 'Convert PDF pages to JPG images'
            },
            {
                name: 'JPG to PDF',
                icon: 'fa-file-pdf',
                description: 'Convert JPG images to PDF format'
            },
            {
                name: 'Compress PDF',
                icon: 'fa-compress',
                description: 'Reduce PDF file size while maintaining quality',
                options: {
                    id: 'compression-level',
                    type: 'select',
                    label: 'Compression Level',
                    values: ['Low', 'Medium', 'High']
                }
            }
        ];

        // DOM Elements
        const hamburger = document.querySelector('.hamburger');
        const sidebar = document.querySelector('.sidebar');
        const toolGrid = document.querySelector('.tool-grid');
        const modalOverlay = document.querySelector('.modal-overlay');
        const modalContainer = document.querySelector('.modal-container');
        const modalClose = document.querySelector('.modal-close');
        const modalTitle = document.getElementById('modal-title');
        const fileInput = document.getElementById('file-input');
        const fileUploadArea = document.querySelector('.file-upload-area');
        const filePreviews = document.getElementById('file-previews');
        const modalOptionsContainer = document.getElementById('modal-options');
        const processBtn = document.getElementById('process-btn');
        const loadingOverlay = document.querySelector('.loading-overlay');

        // State
        let uploadedFiles = [];

        function populateUI() {
            tools.forEach(tool => {
                const toolCard = document.createElement('div');
                toolCard.className = 'tool-card';
                toolCard.innerHTML = `
                    <i class="fas ${tool.icon}"></i>
                    <h3>${tool.name}</h3>
                    <p>${tool.description}</p>
                `;
                toolCard.addEventListener('click', () => openModal(tool.name));
                toolGrid.appendChild(toolCard);
            });
        }

        function handleFiles(newFiles) {
            console.log('handleFiles called with:', newFiles?.length, 'files');
            
            if (!newFiles || newFiles.length === 0) {
                console.log('No files to handle');
                return;
            }

            uploadedFiles = [];
            filePreviews.innerHTML = '';

            const filesToAdd = Array.from(newFiles);
            
            filesToAdd.forEach(file => {
                uploadedFiles.push(file);
                const previewItem = document.createElement('div');
                previewItem.className = 'file-preview-item';
                previewItem.setAttribute('data-filename', file.name);
                previewItem.innerHTML = `
                    <span><i class="fas fa-file-alt"></i> ${file.name}</span>
                    <span class="status-badge">Ready</span>
                `;
                filePreviews.appendChild(previewItem);
            });

            if (uploadedFiles.length > 0) {
                console.log('Showing process button');
                processBtn.style.display = 'inline-block';
                processBtn.style.visibility = 'visible';
                processBtn.style.opacity = '1';
                
                setTimeout(() => {
                    processBtn.style.display = 'inline-block';
                }, 100);
            }
        }

        function openModal(toolName) {
            const tool = tools.find(t => t.name === toolName);
            if (!tool) return;

            modalTitle.textContent = tool.name;
            filePreviews.innerHTML = '';
            modalOptionsContainer.innerHTML = '';
            uploadedFiles = [];
            
            processBtn.style.display = 'none';
            processBtn.style.visibility = 'hidden';
            processBtn.style.opacity = '0';
            
            fileInput.value = '';

            fileInput.multiple = ['Merge PDF', 'JPG to PDF'].includes(tool.name);
            fileInput.accept = tool.name.includes('JPG to') ? 'image/jpeg,image/jpg' : 'application/pdf';

            if (tool.options) {
                let optionsHtml = `<div class="modal-options">`;
                if (tool.options.type === 'select') {
                    optionsHtml += `
                        <label for="${tool.options.id}">${tool.options.label}</label>
                        <select id="${tool.options.id}">
                            ${tool.options.values.map(v => `<option value="${v}">${v}</option>`).join('')}
                        </select>
                    `;
                } else {
                    optionsHtml += `
                        <label for="${tool.options.id}">${tool.options.label}</label>
                        <input type="${tool.options.type}" id="${tool.options.id}" placeholder="${tool.options.label}">
                    `;
                }
                optionsHtml += `</div>`;
                modalOptionsContainer.innerHTML = optionsHtml;
                modalOptionsContainer.style.display = 'block';
            } else {
                modalOptionsContainer.style.display = 'none';
            }

            modalOverlay.classList.add('active');
            modalContainer.classList.add('active');
            sidebar.classList.remove('active');
        }

        function setupEventListeners() {
            hamburger.addEventListener('click', () => {
                sidebar.classList.toggle('active');
            });

            modalClose.addEventListener('click', () => {
                modalOverlay.classList.remove('active');
                modalContainer.classList.remove('active');
            });

            modalOverlay.addEventListener('click', (e) => {
                if (e.target === modalOverlay) {
                    modalOverlay.classList.remove('active');
                    modalContainer.classList.remove('active');
                }
            });

            fileUploadArea.addEventListener('click', () => fileInput.click());
            fileUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileUploadArea.style.borderColor = 'var(--color-secondary-accent)';
            });

            fileUploadArea.addEventListener('dragleave', () => {
                fileUploadArea.style.borderColor = 'var(--color-primary-accent)';
            });

            fileUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                fileUploadArea.style.borderColor = 'var(--color-primary-accent)';
                handleFiles(e.dataTransfer.files);
            });

            fileInput.addEventListener('change', (e) => {
                console.log('File input change event triggered');
                if (e.target.files && e.target.files.length > 0) {
                    handleFiles(e.target.files);
                }
            });

            processBtn.addEventListener('click', () => {
                if (uploadedFiles.length === 0) return;

                const toolName = modalTitle.textContent;
                const options = {};
                
                if (toolName === 'Compress PDF') {
                    options.compressionLevel = document.getElementById('compression-level').value;
                }

                // Show loading overlay
                loadingOverlay.style.display = 'flex';

                // Convert files to base64
                const filePromises = uploadedFiles.map(file => {
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = e => resolve({
                            name: file.name,
                            data: e.target.result.split(',')[1]
                        });
                        reader.onerror = reject;
                        reader.readAsDataURL(file);
                    });
                });

                Promise.all(filePromises)
                    .then(files => {
                        // Send data to Android
                        if (typeof Android !== 'undefined') {
                            Android.processFiles(JSON.stringify({
                                tool: toolName,
                                files: files,
                                options: options
                            }));
                        } else {
                            console.log('Android interface not available');
                        }
                    })
                    .catch(error => {
                        console.error('Error processing files:', error);
                        loadingOverlay.style.display = 'none';
                    });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Initializing app...');
            if (typeof Android !== 'undefined') {
                console.log('Running in Android WebView');
            }
            populateUI();
            setupEventListeners();
        });
    </script>
</body>
</html>

    
        
